<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Lompatan Perkalian Bilangan Bulat</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --ungu-pastel: #c8b6ff;
            --biru-pastel: #b8e0f5;
            --hijau-lucu: #b7e4c7;
            --merah-lembut: #f5b8b8;
            --kuning-lembut: #ffe4b5;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, var(--biru-pastel) 0%, var(--ungu-pastel) 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .navbar {
        background: linear-gradient(
          135deg,
          #b794f4 0%,
          #9f7aea 50%,
          #805ad5 100%
        );
        box-shadow: 0 8px 32px rgba(149, 117, 205, 0.4);
        padding: 1.2rem 2rem;
        border-radius: 0 0 30px 30px;
        backdrop-filter: blur(10px);
        width: 100%;
        position: fixed;
        top: 0;
        left: 0;
        z-index: 1000;
      }

      .container-fluid {
        max-width: 1400px;
        margin: 0 auto;
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
      }

      .navbar-brand {
        color: #ffffff !important;
        font-weight: 700;
        font-size: 1.5rem;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        transition: all 0.3s ease;
        text-decoration: none;
      }

      .navbar-brand::before {
        content: "‚ú® ";
      }

      .navbar-brand::after {
        content: " ‚ú®";
      }

      .navbar-brand:hover {
        transform: scale(1.05) rotate(-2deg);
        text-shadow: 3px 3px 8px rgba(0, 0, 0, 0.3);
      }

      .navbar-toggler {
        border: none;
        padding: 0.5rem;
        background: white;
        border-radius: 15px;
        cursor: pointer;
        display: none;
      }

      .navbar-toggler-icon {
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba(128, 90, 213, 1)' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");
        display: inline-block;
        width: 1.5em;
        height: 1.5em;
        vertical-align: middle;
        background-repeat: no-repeat;
        background-position: center;
        background-size: 100%;
      }

      .navbar-collapse {
        display: flex;
        justify-content: flex-end;
      }

      .navbar-nav {
        display: flex;
        list-style: none;
        margin: 0;
        padding: 0;
        align-items: center;
      }

      .nav-item {
        margin: 0;
        align-self: start;
      }

      .nav-link {
        color: #ffffff !important;
        font-weight: 600;
        margin: 0 0.5rem;
        padding: 0.6rem 1.2rem !important;
        border-radius: 20px;
        transition: all 0.3s ease;
        position: relative;
        text-decoration: none;
        display: block;
      }

      .nav-link:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: translateY(-3px);
        box-shadow: 0 4px 12px rgba(255, 255, 255, 0.3);
      }

      .nav-link.active {
        background: rgba(255, 255, 255, 0.4);
        box-shadow: 0 4px 12px rgba(255, 255, 255, 0.3);
      }

      @media (max-width: 991px) {
        .navbar-toggler {
          display: block;
        }

        .navbar-collapse {
          display: none;
          width: 100%;
          margin-top: 1rem;
        }

        .navbar-collapse.show {
          display: block !important;
        }

        .navbar-nav {
          flex-direction: column;
          gap: 0.5rem;
        }

        .nav-link {
          margin: 0;
          text-align: center;
        }

        .navbar-brand {
          font-size: 1.2rem;
        }
      }
        .container {
            background: white;
            border-radius: 30px;
            padding: 30px;
            max-width: 1000px;
            width: 100%;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            margin-top: 120px;
        }

        h1 {
            text-align: center;
            color: #6b4ce6;
            font-size: 2em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .subtitle {
            text-align: center;
            color: #666;
            font-size: 0.9em;
            margin-bottom: 25px;
        }

        .soal-section {
            background: linear-gradient(135deg, var(--ungu-pastel), var(--biru-pastel));
            padding: 25px;
            border-radius: 20px;
            margin-bottom: 25px;
            text-align: center;
        }

        .soal {
            font-size: 3em;
            font-weight: 700;
            color: #333;
            margin-bottom: 10px;
        }

        .instruksi {
            background: white;
            padding: 15px;
            border-radius: 15px;
            font-size: 0.9em;
            color: #555;
            line-height: 1.6;
        }

        .garis-bilangan-container {
            background: #f8f9fa;
            padding: 30px 20px;
            border-radius: 20px;
            margin: 25px 0;
            overflow-x: auto;
            overflow-y: hidden;
            position: relative;
        }

        .canvas-wrapper {
            position: relative;
            width: 100%;
            overflow-x: auto;
            overflow-y: hidden;
            cursor: grab;
        }

        .canvas-wrapper:active {
            cursor: grabbing;
        }

        #canvas {
            display: block;
            margin: 0 auto;
        }

        .info-text {
            text-align: center;
            color: #666;
            font-size: 0.85em;
            margin-top: 15px;
            font-style: italic;
        }

        .arrow-controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .arrow-control-group {
            background: #f0f0f0;
            padding: 15px;
            border-radius: 15px;
            text-align: center;
        }

        .arrow-control-label {
            font-size: 0.85em;
            color: #666;
            margin-bottom: 10px;
        }

        .arrow-buttons {
            display: flex;
            gap: 10px;
        }

        .arrow-btn {
            padding: 12px 20px;
            font-size: 1.5em;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            background: white;
            transition: all 0.3s;
            box-shadow: 0 3px 8px rgba(0,0,0,0.1);
        }

        .arrow-btn:hover {
            transform: scale(1.1);
        }

        .arrow-btn.selected {
            background: var(--hijau-lucu);
            border: 3px solid #2d5016;
        }

        .control-btn {
            padding: 10px 20px;
            font-size: 0.9em;
            font-weight: 600;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            background: var(--biru-pastel);
            color: #333;
            transition: all 0.3s;
            box-shadow: 0 3px 8px rgba(0,0,0,0.1);
        }

        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 12px rgba(0,0,0,0.15);
        }

        .jawaban-section {
            text-align: center;
            margin: 25px 0;
        }

        .jawaban-label {
            font-size: 1.2em;
            color: #333;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .jawaban-display {
            font-size: 2.5em;
            font-weight: 700;
            color: #6b4ce6;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            background: white;
            border: 3px solid var(--biru-pastel);
            border-radius: 12px;
            padding: 10px;
        }

        .number-pad {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            max-width: 350px;
            margin: 0 auto 20px;
        }

        .num-btn {
            padding: 18px;
            font-size: 1.4em;
            font-weight: 600;
            border: none;
            border-radius: 12px;
            background: var(--biru-pastel);
            color: #333;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        .num-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.15);
        }

        .num-btn:active {
            transform: translateY(0);
        }

        .operator-btn {
            background: var(--ungu-pastel);
        }

        .clear-btn {
            background: var(--merah-lembut);
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 15px 30px;
            font-size: 1.1em;
            font-weight: 600;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        .btn-check {
            background: var(--hijau-lucu);
            color: #2d5016;
        }

        .btn-new {
            background: var(--kuning-lembut);
            color: #8b6914;
        }

        .btn-reset {
            background: var(--merah-lembut);
            color: #8b1414;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.15);
        }

        .feedback {
            text-align: center;
            font-size: 1.3em;
            font-weight: 600;
            margin-top: 20px;
            min-height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .feedback.correct {
            color: #2d5016;
        }

        .feedback.wrong {
            color: #c74444;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .shake {
            animation: shake 0.5s;
        }

        @keyframes confetti {
            0% { transform: scale(0) rotate(0deg); opacity: 0; }
            50% { opacity: 1; }
            100% { transform: scale(1) rotate(360deg); opacity: 0; }
        }

        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: var(--hijau-lucu);
            animation: confetti 1s ease-out;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.5em;
            }
            .soal {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg">
      <div class="container-fluid">
        <a class="navbar-brand" href="#">Pembelajaran Bilangan Bulat</a>
        <button class="navbar-toggler" type="button">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="navbar-collapse" id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" href="index.html">‚ûï Penjumlahan</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="pengurangan.html">‚ûñ Pengurangan</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="perkalian.html">‚úñÔ∏è Perkalian</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="Interaktif1.html">üß© Interaktif Penjumlahan dan Pengurangan</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="Interaktif2.html">üïπÔ∏è Interaktif Perkalian</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="game.html">üéÆ Permainan</a>
            </li>
          </ul>

        </div>
      </div>
    </nav>
    <div class="container">
        <h1>üéÆ Game Lompatan Perkalian Bilangan Bulat</h1>
        <p class="subtitle">Buat panah lompatan untuk menemukan hasil perkalian!</p>

        <div class="soal-section">
            <div class="soal" id="soal">3 √ó 2 = ?</div>
            <div class="instruksi">
                <strong>Cara bermain:</strong> Gambar panah untuk menunjukkan lompatan dari 0. 
                Sesuaikan jumlah panah, panjang panah, dan arah panah untuk menemukan jawabannya!<br>
                <em>üí° Tip: Arah menghadap panah menentukan arah lompatan!</em>
            </div>
        </div>

        <div class="garis-bilangan-container">
            <div class="canvas-wrapper" id="canvasWrapper">
                <canvas id="canvas"></canvas>
            </div>
            
            <div class="arrow-controls">
                <div class="arrow-control-group">
                    <div class="arrow-control-label">Jumlah Panah</div>
                    <div class="arrow-buttons">
                        <button class="control-btn" onclick="changeArrowCount(-1)">‚àí</button>
                        <button class="control-btn" id="arrowCount" style="min-width: 60px;">1</button>
                        <button class="control-btn" onclick="changeArrowCount(1)">+</button>
                    </div>
                </div>
                
                <div class="arrow-control-group">
                    <div class="arrow-control-label">Panjang Lompatan</div>
                    <div class="arrow-buttons">
                        <button class="control-btn" onclick="changeJumpSize(-1)">‚àí</button>
                        <button class="control-btn" id="jumpSize" style="min-width: 60px;">1</button>
                        <button class="control-btn" onclick="changeJumpSize(1)">+</button>
                    </div>
                </div>
                
                <div class="arrow-control-group">
                    <div class="arrow-control-label">Arah Menghadap Panah</div>
                    <div class="arrow-buttons">
                        <button class="arrow-btn" onclick="setArrowHead('left')" id="headLeft">‚óÄÔ∏è</button>
                        <button class="arrow-btn" onclick="setArrowHead('right')" id="headRight">‚ñ∂Ô∏è</button>
                    </div>
                </div>
            </div>
            
            <div class="info-text">
                üí° Posisi akhir panah adalah hasil perkalianmu! Geser canvas dengan mouse/jari untuk melihat lebih jauh.
            </div>
        </div>

        <div class="jawaban-section">
            <div class="jawaban-label">Masukkan Jawabanmu:</div>
            <div class="jawaban-display" id="jawaban-display">_</div>
            
            <div class="number-pad">
                <button class="num-btn" onclick="addNumber('7')">7</button>
                <button class="num-btn" onclick="addNumber('8')">8</button>
                <button class="num-btn" onclick="addNumber('9')">9</button>
                <button class="num-btn clear-btn" onclick="clearAnswer()">C</button>
                
                <button class="num-btn" onclick="addNumber('4')">4</button>
                <button class="num-btn" onclick="addNumber('5')">5</button>
                <button class="num-btn" onclick="addNumber('6')">6</button>
                <button class="num-btn operator-btn" onclick="toggleSign()">+/‚àí</button>
                
                <button class="num-btn" onclick="addNumber('1')">1</button>
                <button class="num-btn" onclick="addNumber('2')">2</button>
                <button class="num-btn" onclick="addNumber('3')">3</button>
                <button class="num-btn operator-btn" onclick="deleteNumber()">‚å´</button>
                
                <button class="num-btn" onclick="addNumber('0')" style="grid-column: span 2;">0</button>
                <button class="num-btn clear-btn" onclick="clearAnswer()" style="grid-column: span 2;">Clear</button>
            </div>
            
            <div class="action-buttons">
                <button class="btn btn-reset" onclick="resetArrows()">üîÑ Reset Panah</button>
                <button class="btn btn-check" onclick="checkAnswer()">üéØ Periksa Jawaban</button>
                <button class="btn btn-new" onclick="newQuestion()">üìù Soal Baru</button>
            </div>

            <div class="feedback" id="feedback"></div>
        </div>
    </div>
    <script>
        const toggler = document.querySelector('.navbar-toggler');
        const collapse = document.querySelector('.navbar-collapse');

        toggler.addEventListener('click', () => {
            collapse.classList.toggle('show');
        });
    </script>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const canvasWrapper = document.getElementById('canvasWrapper');
        
        let currentA = 3;
        let currentB = 2;
        let offsetX = 0;
        let isDragging = false;
        let startX = 0;
        
        // Kontrol siswa
        let arrowCount = 1;
        let jumpSize = 1;
        let arrowHead = 1; // 1 = kanan, -1 = kiri
        
        // Jawaban siswa
        let userAnswer = '';
        
        // Ukuran canvas dinamis
        const scale = 40;
        const canvasHeight = 250;
        let canvasWidth = 3000; // Canvas yang sangat lebar
        
        function initCanvas() {
            canvas.width = canvasWidth;
            canvas.height = canvasHeight;
            centerView();
        }
        
        function centerView() {
            // Hitung posisi akhir panah
            const finalPos = arrowCount * jumpSize * arrowHead;
            
            // Pusatkan view agar menampilkan dari 0 ke posisi akhir
            const wrapperWidth = canvasWrapper.clientWidth;
            const centerCanvas = canvasWidth / 2;
            const finalPosX = finalPos * scale;
            
            // Jika hasil positif, tampilkan dari 0 ke kanan
            // Jika hasil negatif, tampilkan dari 0 ke kiri
            if (finalPos >= 0) {
                offsetX = centerCanvas - (finalPosX / 2) - wrapperWidth / 2;
            } else {
                offsetX = centerCanvas + (Math.abs(finalPosX) / 2) - wrapperWidth / 2;
            }
            
            // Scroll canvas wrapper
            canvasWrapper.scrollLeft = offsetX;
        }
        
        function drawNumberLine() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            const centerY = canvas.height / 2;
            const centerX = canvas.width / 2;
            
            // Gambar garis utama
            ctx.strokeStyle = '#666';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(0, centerY);
            ctx.lineTo(canvas.width, centerY);
            ctx.stroke();
            
            // Gambar angka dan tanda
            ctx.fillStyle = '#333';
            ctx.font = 'bold 14px Poppins';
            ctx.textAlign = 'center';
            
            // Hitung range yang perlu digambar
            const rangeStart = -Math.floor(canvasWidth / (2 * scale));
            const rangeEnd = Math.floor(canvasWidth / (2 * scale));
            
            for (let i = rangeStart; i <= rangeEnd; i++) {
                const x = centerX + (i * scale);
                
                // Tanda kecil
                ctx.strokeStyle = '#666';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(x, centerY - 10);
                ctx.lineTo(x, centerY + 10);
                ctx.stroke();
                
                // Angka setiap 5 untuk tidak terlalu padat
                if (i % 5 === 0 || i === 0) {
                    ctx.fillStyle = i === 0 ? '#6b4ce6' : '#333';
                    ctx.font = i === 0 ? 'bold 18px Poppins' : 'bold 14px Poppins';
                    ctx.fillText(i.toString(), x, centerY + 30);
                }
            }
            
            // Highlight titik 0
            const zeroX = centerX;
            ctx.fillStyle = '#6b4ce6';
            ctx.beginPath();
            ctx.arc(zeroX, centerY, 10, 0, Math.PI * 2);
            ctx.fill();
            
            // Gambar panah siswa
            drawStudentArrows();
        }

        function drawStudentArrows() {
            const centerY = canvas.height / 2;
            const centerX = canvas.width / 2;
            
            // Arah lompatan mengikuti arah menghadap panah
            const direction = arrowHead;
            
            let currentPos = 0;
            
            for (let i = 0; i < arrowCount; i++) {
                const startX = centerX + (currentPos * scale);
                const endPos = currentPos + (jumpSize * direction);
                const endX = centerX + (endPos * scale);
                const y = centerY - 50 - (i * 20);
                
                // Gambar panah
                drawArrow(startX, y, endX, y, arrowHead, i);
                
                currentPos = endPos;
            }
            
            // Gambar posisi akhir
            const finalX = centerX + (currentPos * scale);
            ctx.fillStyle = '#ff4757';
            ctx.beginPath();
            ctx.arc(finalX, centerY, 10, 0, Math.PI * 2);
            ctx.fill();
            
            // Label hasil
            ctx.fillStyle = '#ff4757';
            ctx.font = 'bold 18px Poppins';
            ctx.fillText('Hasil: ' + currentPos, finalX, centerY - 80);
        }

        function addNumber(num) {
            if (userAnswer.length < 4) { // Batasi maksimal 4 digit
                if (userAnswer === '' || userAnswer === '0') {
                    userAnswer = num;
                } else {
                    userAnswer += num;
                }
                updateAnswerDisplay();
            }
        }

        function toggleSign() {
            if (userAnswer === '' || userAnswer === '0') {
                userAnswer = '-';
            } else if (userAnswer === '-') {
                userAnswer = '';
            } else if (userAnswer.startsWith('-')) {
                userAnswer = userAnswer.substring(1);
            } else {
                userAnswer = '-' + userAnswer;
            }
            updateAnswerDisplay();
        }

        function deleteNumber() {
            if (userAnswer.length > 0) {
                userAnswer = userAnswer.slice(0, -1);
                updateAnswerDisplay();
            }
        }

        function clearAnswer() {
            userAnswer = '';
            updateAnswerDisplay();
        }

        function updateAnswerDisplay() {
            const display = document.getElementById('jawaban-display');
            if (userAnswer === '' || userAnswer === '-') {
                display.textContent = userAnswer || '_';
            } else {
                display.textContent = userAnswer;
            }
        }

        function drawArrow(x1, y1, x2, y2, headDir, index) {
            const colors = ['#ff6b9d', '#c44569', '#ffa502', '#ff6348', '#ff4757', '#9b59b6', '#3498db'];
            ctx.strokeStyle = colors[index % colors.length];
            ctx.fillStyle = colors[index % colors.length];
            ctx.lineWidth = 4;
            
            // Garis panah
            ctx.beginPath();
            ctx.moveTo(x1, y1);
            ctx.lineTo(x2, y2);
            ctx.stroke();
            
            // Kepala panah
            const headLength = 15;
            const angle = Math.atan2(y2 - y1, x2 - x1);
            
            if (headDir > 0) {
                // Kepala panah ke kanan
                const tipX = x2;
                const tipY = y2;
                ctx.beginPath();
                ctx.moveTo(tipX, tipY);
                ctx.lineTo(tipX - headLength * Math.cos(angle - Math.PI / 6), tipY - headLength * Math.sin(angle - Math.PI / 6));
                ctx.lineTo(tipX - headLength * Math.cos(angle + Math.PI / 6), tipY - headLength * Math.sin(angle + Math.PI / 6));
                ctx.closePath();
                ctx.fill();
            } else {
                // Kepala panah ke kiri
                const tipX = x1;
                const tipY = y1;
                ctx.beginPath();
                ctx.moveTo(tipX, tipY);
                ctx.lineTo(tipX + headLength * Math.cos(angle - Math.PI / 6 + Math.PI), tipY + headLength * Math.sin(angle - Math.PI / 6 + Math.PI));
                ctx.lineTo(tipX + headLength * Math.cos(angle + Math.PI / 6 + Math.PI), tipY + headLength * Math.sin(angle + Math.PI / 6 + Math.PI));
                ctx.closePath();
                ctx.fill();
            }
            
            // Titik awal
            ctx.fillStyle = colors[index % colors.length];
            ctx.beginPath();
            ctx.arc(x1, y1, 5, 0, Math.PI * 2);
            ctx.fill();
        }

        function changeArrowCount(delta) {
            arrowCount = Math.max(1, Math.min(10, arrowCount + delta));
            document.getElementById('arrowCount').textContent = arrowCount;
            drawNumberLine();
            centerView();
        }

        function changeJumpSize(delta) {
            jumpSize = Math.max(1, Math.min(15, jumpSize + delta));
            document.getElementById('jumpSize').textContent = jumpSize;
            drawNumberLine();
            centerView();
        }

        function setArrowHead(dir) {
            arrowHead = dir === 'right' ? 1 : -1;
            document.getElementById('headLeft').classList.remove('selected');
            document.getElementById('headRight').classList.remove('selected');
            document.getElementById(dir === 'right' ? 'headRight' : 'headLeft').classList.add('selected');
            drawNumberLine();
            centerView();
        }

        function resetArrows() {
            arrowCount = 1;
            jumpSize = 1;
            arrowHead = 1;
            document.getElementById('arrowCount').textContent = arrowCount;
            document.getElementById('jumpSize').textContent = jumpSize;
            document.getElementById('headLeft').classList.remove('selected');
            document.getElementById('headRight').classList.add('selected');
            drawNumberLine();
            centerView();
        }

        function checkAnswer() {
            const correctAnswer = currentA * currentB;
            const studentInput = userAnswer === '' || userAnswer === '-' ? null : parseInt(userAnswer);
            const feedback = document.getElementById('feedback');
            
            if (studentInput === null) {
                feedback.textContent = '‚ö†Ô∏è Masukkan jawaban dulu ya!';
                feedback.className = 'feedback wrong shake';
                setTimeout(() => {
                    feedback.classList.remove('shake');
                }, 500);
                return;
            }
            
            if (studentInput === correctAnswer) {
                feedback.textContent = 'üéâ Sempurna! Jawabanmu benar!';
                feedback.className = 'feedback correct';
                createConfetti();
                playSound();
            } else {
                feedback.textContent = `üòÖ Belum tepat! Jawaban yang benar adalah ${correctAnswer}`;
                feedback.className = 'feedback wrong shake';
                setTimeout(() => {
                    feedback.classList.remove('shake');
                }, 500);
            }
        }

        function createConfetti() {
            for (let i = 0; i < 40; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * window.innerWidth + 'px';
                    confetti.style.top = Math.random() * window.innerHeight + 'px';
                    confetti.style.background = ['#b7e4c7', '#c8b6ff', '#b8e0f5', '#ffe4b5'][Math.floor(Math.random() * 4)];
                    document.body.appendChild(confetti);
                    setTimeout(() => confetti.remove(), 1000);
                }, i * 30);
            }
        }

        function playSound() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.value = 800;
            oscillator.type = 'sine';
            
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.3);
        }

        function newQuestion() {
            const signs = [1, -1];
            currentA = (Math.floor(Math.random() * 5) + 1) * signs[Math.floor(Math.random() * 2)];
            currentB = (Math.floor(Math.random() * 4) + 1) * signs[Math.floor(Math.random() * 2)];
            
            document.getElementById('soal').textContent = `${currentA} √ó ${currentB} = ?`;
            document.getElementById('feedback').textContent = '';
            document.getElementById('feedback').className = 'feedback';
            clearAnswer();
            resetArrows();
        }

        // Drag untuk menggeser canvas
        let scrollStartX = 0;
        canvasWrapper.addEventListener('mousedown', (e) => {
            isDragging = true;
            scrollStartX = e.clientX + canvasWrapper.scrollLeft;
        });

        canvasWrapper.addEventListener('mousemove', (e) => {
            if (isDragging) {
                canvasWrapper.scrollLeft = scrollStartX - e.clientX;
            }
        });

        canvasWrapper.addEventListener('mouseup', () => {
            isDragging = false;
        });

        canvasWrapper.addEventListener('mouseleave', () => {
            isDragging = false;
        });

        // Touch support
        canvasWrapper.addEventListener('touchstart', (e) => {
            isDragging = true;
            scrollStartX = e.touches[0].clientX + canvasWrapper.scrollLeft;
        });

        canvasWrapper.addEventListener('touchmove', (e) => {
            if (isDragging) {
                canvasWrapper.scrollLeft = scrollStartX - e.touches[0].clientX;
            }
        });

        canvasWrapper.addEventListener('touchend', () => {
            isDragging = false;
        });

        // Inisialisasi
        initCanvas();
        setArrowHead('right');
        drawNumberLine();
        centerView();
    </script>
</body>
</html>