<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Game Garis Bilangan</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Poppins", sans-serif;
        background: linear-gradient(135deg, #e0c3fc 0%, #8ec5fc 100%);
        min-height: 100vh;
        padding: 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      .navbar {
        background: linear-gradient(
          135deg,
          #b794f4 0%,
          #9f7aea 50%,
          #805ad5 100%
        );
        box-shadow: 0 8px 32px rgba(149, 117, 205, 0.4);
        padding: 1.2rem 2rem;
        border-radius: 0 0 30px 30px;
        backdrop-filter: blur(10px);
        width: 100%;
        position: fixed;
        top: 0;
        left: 0;
        z-index: 1000;
      }

      .container-fluid {
        max-width: 1400px;
        margin: 0 auto;
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
      }

      .navbar-brand {
        color: #ffffff !important;
        font-weight: 700;
        font-size: 1.5rem;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        transition: all 0.3s ease;
        text-decoration: none;
      }

      .navbar-brand::before {
        content: "‚ú® ";
      }

      .navbar-brand::after {
        content: " ‚ú®";
      }

      .navbar-brand:hover {
        transform: scale(1.05) rotate(-2deg);
        text-shadow: 3px 3px 8px rgba(0, 0, 0, 0.3);
      }

      .navbar-toggler {
        border: none;
        padding: 0.5rem;
        background: white;
        border-radius: 15px;
        cursor: pointer;
        display: none;
      }

      .navbar-toggler-icon {
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba(128, 90, 213, 1)' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");
        display: inline-block;
        width: 1.5em;
        height: 1.5em;
        vertical-align: middle;
        background-repeat: no-repeat;
        background-position: center;
        background-size: 100%;
      }

      .navbar-collapse {
        display: flex;
        justify-content: flex-end;
      }

      .navbar-nav {
        display: flex;
        list-style: none;
        margin: 0;
        padding: 0;
        align-items: center;
      }

      .nav-item {
        margin: 0;
      }

      .nav-link {
        color: #ffffff !important;
        font-weight: 600;
        margin: 0 0.5rem;
        padding: 0.6rem 1.2rem !important;
        border-radius: 20px;
        transition: all 0.3s ease;
        position: relative;
        text-decoration: none;
        display: block;
      }

      .nav-link:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: translateY(-3px);
        box-shadow: 0 4px 12px rgba(255, 255, 255, 0.3);
      }

      .nav-link.active {
        background: rgba(255, 255, 255, 0.4);
        box-shadow: 0 4px 12px rgba(255, 255, 255, 0.3);
      }

      @media (max-width: 991px) {
        .navbar-toggler {
          display: block;
        }

        .navbar-collapse {
          display: none;
          width: 100%;
          margin-top: 1rem;
        }

        .navbar-collapse.show {
          display: block !important;
        }

        .navbar-nav {
          flex-direction: column;
          gap: 0.5rem;
        }

        .nav-link {
          margin: 0;
          text-align: center;
        }

        .navbar-brand {
          font-size: 1.2rem;
        }
      }
      header {
        text-align: center;
        margin-bottom: 30px;
        margin-top: 120px;
      }

      h1 {
        color: #6b4ce8;
        font-size: 2.2em;
        font-weight: 700;
        text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.1);
        margin-bottom: 10px;
      }

      .subtitle {
        color: #5a67d8;
        font-size: 1.1em;
        font-weight: 400;
      }

      main {
        background: white;
        border-radius: 30px;
        padding: 40px;
        box-shadow: 0 10px 40px rgba(107, 76, 232, 0.2);
        max-width: 900px;
        width: 100%;
      }

      .question-box {
        background: linear-gradient(135deg, #ddd6fe 0%, #bfdbfe 100%);
        border-radius: 20px;
        padding: 30px;
        text-align: center;
        margin-bottom: 30px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      }

      .question-text {
        font-size: 2.5em;
        font-weight: 700;
        color: #5b21b6;
        margin-bottom: 10px;
      }

      .instruction {
        color: #6366f1;
        font-size: 0.95em;
        margin-top: 10px;
      }

      .number-line-container {
        position: relative;
        padding: 60px 20px;
        margin: 30px 0;
        overflow: hidden;
      }

      .canvas-wrapper {
        position: relative;
        width: 100%;
        height: 250px;
        overflow-x: auto;
        overflow-y: hidden;
        border-radius: 15px;
        background: #f9fafb;
      }

      canvas {
        display: block;
        cursor: grab;
      }

      canvas:active {
        cursor: grabbing;
      }

      .zoom-controls {
        text-align: center;
        margin-top: 15px;
        display: flex;
        justify-content: center;
        gap: 10px;
        align-items: center;
      }

      .zoom-btn {
        background: linear-gradient(135deg, #a78bfa 0%, #818cf8 100%);
        border: none;
        border-radius: 10px;
        width: 40px;
        height: 40px;
        font-size: 1.3em;
        font-weight: 700;
        color: white;
        cursor: pointer;
        transition: all 0.2s ease;
        box-shadow: 0 2px 5px rgba(139, 92, 246, 0.3);
      }

      .zoom-btn:hover {
        transform: scale(1.1);
      }

      .zoom-info {
        color: #5b21b6;
        font-weight: 600;
        font-size: 0.9em;
        padding: 0 10px;
      }

      .arrow-controls {
        background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
        border-radius: 20px;
        padding: 25px;
        margin: 25px 0;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      }

      .arrow-controls h3 {
        color: #92400e;
        font-size: 1.3em;
        margin-bottom: 15px;
        text-align: center;
      }

      .arrow-section {
        background: white;
        border-radius: 15px;
        padding: 20px;
        margin-bottom: 15px;
        border: 3px solid #fcd34d;
      }

      .arrow-section:last-child {
        margin-bottom: 0;
      }

      .arrow-title {
        font-weight: 600;
        color: #b45309;
        margin-bottom: 15px;
        font-size: 1.1em;
      }

      .arrow-inputs {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
        margin-bottom: 15px;
      }

      .input-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .input-group label {
        font-size: 0.9em;
        color: #78350f;
        font-weight: 600;
      }

      .number-input-wrapper {
        display: flex;
        align-items: center;
        gap: 8px;
        background: #f3f4f6;
        border-radius: 12px;
        padding: 5px;
      }

      .input-btn {
        background: linear-gradient(135deg, #a78bfa 0%, #818cf8 100%);
        border: none;
        border-radius: 10px;
        width: 35px;
        height: 35px;
        font-size: 1.2em;
        font-weight: 700;
        color: white;
        cursor: pointer;
        transition: all 0.2s ease;
        box-shadow: 0 2px 5px rgba(139, 92, 246, 0.3);
      }

      .input-btn:hover {
        transform: scale(1.1);
      }

      .input-btn:active {
        transform: scale(0.95);
      }

      .number-input {
        flex: 1;
        text-align: center;
        font-size: 1.3em;
        font-weight: 700;
        color: #5b21b6;
        background: white;
        border: 2px solid #c7d2fe;
        border-radius: 8px;
        padding: 8px;
        outline: none;
        transition: all 0.2s ease;
      }

      .number-input:focus {
        border-color: #818cf8;
        box-shadow: 0 0 0 3px rgba(129, 140, 248, 0.2);
      }

      .arrow-color-indicator {
        display: inline-block;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        margin-left: 10px;
        vertical-align: middle;
      }

      .arrow1-color {
        background: #10b981;
      }

      .arrow2-color {
        background: #f59e0b;
      }

      .answer-section {
        text-align: center;
        margin: 30px 0;
      }

      .answer-display {
        background: #f3f4f6;
        border: 3px solid #c7d2fe;
        border-radius: 15px;
        padding: 15px 30px;
        font-size: 1.8em;
        font-weight: 600;
        color: #4c1d95;
        min-width: 150px;
        display: inline-block;
        margin-bottom: 20px;
        min-height: 60px;
        line-height: 60px;
      }

      .keypad {
        display: grid;
        grid-template-columns: repeat(6, 1fr);
        gap: 10px;
        max-width: 500px;
        margin: 20px auto;
      }

      .key-btn {
        background: linear-gradient(135deg, #a78bfa 0%, #818cf8 100%);
        border: none;
        border-radius: 15px;
        padding: 15px;
        font-size: 1.5em;
        font-weight: 600;
        color: white;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 10px rgba(139, 92, 246, 0.3);
      }

      .key-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 15px rgba(139, 92, 246, 0.4);
      }

      .key-btn:active {
        transform: translateY(0);
      }

      .control-buttons {
        display: flex;
        gap: 15px;
        justify-content: center;
        margin-top: 25px;
        flex-wrap: wrap;
      }

      .btn {
        padding: 15px 35px;
        border: none;
        border-radius: 20px;
        font-size: 1.1em;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      }

      .btn-check {
        background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        color: white;
      }

      .btn-check:hover {
        transform: scale(1.05);
      }

      .btn-new {
        background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        color: white;
      }

      .btn-new:hover {
        transform: scale(1.05);
      }

      .btn-reset {
        background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        color: white;
      }

      .btn-reset:hover {
        transform: scale(1.05);
      }

      .feedback {
        text-align: center;
        margin-top: 20px;
        font-size: 1.5em;
        font-weight: 600;
        min-height: 40px;
        animation: fadeIn 0.5s ease;
      }

      .feedback.correct {
        color: #10b981;
      }

      .feedback.incorrect {
        color: #ef4444;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(-10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes bounce {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-10px);
        }
      }

      .bounce {
        animation: bounce 0.5s ease;
      }

      @media (max-width: 768px) {
        h1 {
          font-size: 1.5em;
        }
        .question-text {
          font-size: 2em;
        }
        main {
          padding: 20px;
        }
        .keypad {
          grid-template-columns: repeat(4, 1fr);
        }
        .arrow-inputs {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg">
      <div class="container-fluid">
        <a class="navbar-brand" href="#">Pembelajaran Bilangan Bulat</a>
        <button class="navbar-toggler" type="button">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="navbar-collapse" id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" href="index.html">‚ûï Penjumlahan</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="pengurangan.html">‚ûñ Pengurangan</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="perkalian.html">‚úñÔ∏è Perkalian</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="Interaktif1.html">üß© Interaktif Penjumlahan dan Pengurangan</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="Interaktif2.html">üïπÔ∏è Interaktif Perkalian</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="game.html">üéÆ Permainan</a>
            </li>
          </ul>

        </div>
      </div>
    </nav>
    <header>
      <h1>üéØ Add-Sub Quest üéØ</h1>
      <div class="subtitle">Penjumlahan & Pengurangan</div>
    </header>
    <!-- Main -->
    <main>
      <div class="question-box">
        <div class="question-text" id="question">3 + 2 = ?</div>
        <div class="instruction">
          Buat panah di garis bilangan untuk menyelesaikan soal! Geser canvas
          untuk melihat angka lain.
        </div>
      </div>

      <div class="number-line-container">
        <div class="canvas-wrapper" id="canvasWrapper">
          <canvas id="numberLine"></canvas>
        </div>
        <div class="zoom-controls">
          <button class="zoom-btn" onclick="changeSpacing(-5)" title="Zoom Out">
            ‚àí
          </button>
          <span class="zoom-info">Geser untuk melihat lebih banyak angka</span>
          <button class="zoom-btn" onclick="changeSpacing(5)" title="Zoom In">
            +
          </button>
        </div>
      </div>

      <div class="arrow-controls">
        <h3>üé® Kontrol Panah</h3>

        <div class="arrow-section">
          <div class="arrow-title">
            Panah 1 <span class="arrow-color-indicator arrow1-color"></span>
          </div>
          <div class="arrow-inputs">
            <div class="input-group">
              <label>Posisi Awal:</label>
              <div class="number-input-wrapper">
                <button class="input-btn" onclick="changeArrow(1, 'start', -1)">
                  ‚àí
                </button>
                <input
                  type="text"
                  class="number-input"
                  id="arrow1-start"
                  value="0"
                  onchange="updateArrowFromInput(1, 'start')"
                  onkeypress="return allowNumberInput(event)"
                />
                <button class="input-btn" onclick="changeArrow(1, 'start', 1)">
                  +
                </button>
              </div>
            </div>
            <div class="input-group">
              <label>Panjang Panah:</label>
              <div class="number-input-wrapper">
                <button
                  class="input-btn"
                  onclick="changeArrow(1, 'length', -1)"
                >
                  ‚àí
                </button>
                <input
                  type="text"
                  class="number-input"
                  id="arrow1-length"
                  value="0"
                  onchange="updateArrowFromInput(1, 'length')"
                  onkeypress="return allowNumberInput(event)"
                />
                <button class="input-btn" onclick="changeArrow(1, 'length', 1)">
                  +
                </button>
              </div>
            </div>
          </div>
          <div style="text-align: center; margin-top: 10px">
            <button
              class="btn"
              style="
                background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
                color: white;
                padding: 10px 25px;
                font-size: 0.95em;
              "
              onclick="checkArrow(1)"
            >
              üëÅÔ∏è Cek Posisi Panah 1
            </button>
          </div>
        </div>

        <div class="arrow-section">
          <div class="arrow-title">
            Panah 2 <span class="arrow-color-indicator arrow2-color"></span>
          </div>
          <div class="arrow-inputs">
            <div class="input-group">
              <label>Posisi Awal:</label>
              <div class="number-input-wrapper">
                <button class="input-btn" onclick="changeArrow(2, 'start', -1)">
                  ‚àí
                </button>
                <input
                  type="text"
                  class="number-input"
                  id="arrow2-start"
                  value="0"
                  onchange="updateArrowFromInput(2, 'start')"
                  onkeypress="return allowNumberInput(event)"
                />
                <button class="input-btn" onclick="changeArrow(2, 'start', 1)">
                  +
                </button>
              </div>
            </div>
            <div class="input-group">
              <label>Panjang Panah:</label>
              <div class="number-input-wrapper">
                <button
                  class="input-btn"
                  onclick="changeArrow(2, 'length', -1)"
                >
                  ‚àí
                </button>
                <input
                  type="text"
                  class="number-input"
                  id="arrow2-length"
                  value="0"
                  onchange="updateArrowFromInput(2, 'length')"
                  onkeypress="return allowNumberInput(event)"
                />
                <button class="input-btn" onclick="changeArrow(2, 'length', 1)">
                  +
                </button>
              </div>
            </div>
          </div>
          <div style="text-align: center; margin-top: 10px">
            <button
              class="btn"
              style="
                background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
                color: white;
                padding: 10px 25px;
                font-size: 0.95em;
              "
              onclick="checkArrow(2)"
            >
              üëÅÔ∏è Cek Posisi Panah 2
            </button>
          </div>
        </div>
      </div>

      <div class="answer-section">
        <div class="answer-display" id="answerDisplay">_</div>

        <div class="keypad">
          <button class="key-btn" onclick="addDigit('7')">7</button>
          <button class="key-btn" onclick="addDigit('8')">8</button>
          <button class="key-btn" onclick="addDigit('9')">9</button>
          <button class="key-btn" onclick="addDigit('4')">4</button>
          <button class="key-btn" onclick="addDigit('5')">5</button>
          <button class="key-btn" onclick="addDigit('6')">6</button>
          <button class="key-btn" onclick="addDigit('1')">1</button>
          <button class="key-btn" onclick="addDigit('2')">2</button>
          <button class="key-btn" onclick="addDigit('3')">3</button>
          <button class="key-btn" onclick="addDigit('-')">‚àí</button>
          <button class="key-btn" onclick="addDigit('0')">0</button>
          <button class="key-btn" onclick="clearAnswer()">‚å´</button>
        </div>

        <div class="control-buttons">
          <button class="btn btn-check" onclick="checkAnswer()">
            ‚úì Periksa Jawaban
          </button>
          <button class="btn btn-reset" onclick="resetArrows()">
            ‚Ü∫ Reset Panah
          </button>
          <button class="btn btn-new" onclick="newQuestion()">
            üîÑ Soal Baru
          </button>
        </div>

        <div class="feedback" id="feedback"></div>
      </div>
    </main>

    <script>
      const canvas = document.getElementById("numberLine");
      const ctx = canvas.getContext("2d");
      const canvasWrapper = document.getElementById("canvasWrapper");

      let currentQuestion = {};
      let userAnswer = "";
      let arrows = {
        1: { start: 0, length: 0 },
        2: { start: 0, length: 0 },
      };

      let spacing = 50;
      let offsetX = 0;
      let isDragging = false;
      let dragStartX = 0;
      let dragStartOffset = 0;

      function initCanvas() {
        canvas.width = 10000;
        canvas.height = 250;
        canvasWrapper.scrollLeft =
          canvas.width / 2 - canvasWrapper.offsetWidth / 2;
      }

      function generateQuestion() {
        const types = [
          {
            type: "pos+pos",
            a: () => Math.floor(Math.random() * 8) + 1,
            b: () => Math.floor(Math.random() * 8) + 1,
          },
          {
            type: "neg+pos",
            a: () => -Math.floor(Math.random() * 8) - 1,
            b: () => Math.floor(Math.random() * 8) + 1,
          },
          {
            type: "pos-pos",
            a: () => Math.floor(Math.random() * 8) + 1,
            b: () => Math.floor(Math.random() * 8) + 1,
            op: "-",
          },
          {
            type: "neg-pos",
            a: () => -Math.floor(Math.random() * 5) - 1,
            b: () => Math.floor(Math.random() * 5) + 1,
            op: "-",
          },
        ];

        const selected = types[Math.floor(Math.random() * types.length)];
        const a = selected.a();
        const b = selected.b();
        const op = selected.op || "+";
        const answer = op === "+" ? a + b : a - b;

        return { a, b, op, answer };
      }

      function newQuestion() {
        currentQuestion = generateQuestion();
        document.getElementById(
          "question"
        ).textContent = `${currentQuestion.a} ${currentQuestion.op} ${currentQuestion.b} = ?`;
        userAnswer = "";
        document.getElementById("answerDisplay").textContent = "_";
        document.getElementById("feedback").textContent = "";

        resetArrows();
        drawNumberLine();
      }

      function resetArrows() {
        arrows[1] = { start: 0, length: 0 };
        arrows[2] = { start: 0, length: 0 };
        updateArrowDisplays();
        drawNumberLine();
      }

      function changeArrow(arrowNum, property, delta) {
        if (property === "start") {
          arrows[arrowNum].start += delta;
          scrollToPosition(arrows[arrowNum].start);
        } else if (property === "length") {
          arrows[arrowNum].length += delta;
        }
        updateArrowDisplays();
        drawNumberLine();
      }

      function allowNumberInput(event) {
        const char = event.key;
        const currentValue = event.target.value;

        if (char === "-" && currentValue.length === 0) {
          return true;
        }
        if (char >= "0" && char <= "9") {
          return true;
        }
        if (char === "Enter") {
          event.target.blur();
          return false;
        }

        event.preventDefault();
        return false;
      }

      function updateArrowFromInput(arrowNum, property) {
        const inputId = `arrow${arrowNum}-${property}`;
        const input = document.getElementById(inputId);
        const value = input.value.trim();

        if (value === "" || value === "-") {
          arrows[arrowNum][property] = 0;
          input.value = "0";
        } else {
          const num = parseInt(value);
          if (!isNaN(num)) {
            arrows[arrowNum][property] = num;
            input.value = num.toString();

            // Auto scroll ke posisi panah
            if (property === "start") {
              scrollToPosition(num);
            }
          } else {
            input.value = arrows[arrowNum][property].toString();
          }
        }

        drawNumberLine();
      }

      function scrollToPosition(position) {
        const centerX = canvas.width / 2;
        const targetX = centerX + position * spacing;
        const wrapperWidth = canvasWrapper.offsetWidth;

        // Scroll sehingga posisi target berada di tengah viewport
        canvasWrapper.scrollLeft = targetX - wrapperWidth / 2;
      }

      function checkArrow(arrowNum) {
        const arrow = arrows[arrowNum];
        const startPos = arrow.start;
        const endPos = arrow.start + arrow.length;

        // Scroll ke posisi yang menampilkan seluruh panah
        const centerX = canvas.width / 2;
        const startX = centerX + startPos * spacing;
        const endX = centerX + endPos * spacing;
        const midX = (startX + endX) / 2;
        const wrapperWidth = canvasWrapper.offsetWidth;

        // Scroll ke tengah panah
        canvasWrapper.scrollLeft = midX - wrapperWidth / 2;

        // Highlight panah dengan animasi
        highlightArrow(arrowNum);
      }

      function highlightArrow(arrowNum) {
        const originalColor1 = "#10B981";
        const originalColor2 = "#F59E0B";
        const highlightColor = "#FF00FF";

        let flashCount = 0;
        const flashInterval = setInterval(() => {
          if (flashCount >= 6) {
            clearInterval(flashInterval);
            drawNumberLine();
            return;
          }

          // Ganti warna sementara untuk efek flash
          const tempArrows = JSON.parse(JSON.stringify(arrows));
          ctx.clearRect(0, 0, canvas.width, canvas.height);

          const centerY = canvas.height / 2;
          const centerX = canvas.width / 2;

          const visibleStart = Math.floor((0 - centerX) / spacing) - 2;
          const visibleEnd = Math.ceil((canvas.width - centerX) / spacing) + 2;

          ctx.strokeStyle = "#A78BFA";
          ctx.lineWidth = 4;
          ctx.beginPath();
          ctx.moveTo(0, centerY);
          ctx.lineTo(canvas.width, centerY);
          ctx.stroke();

          ctx.fillStyle = "#5B21B6";
          ctx.font = "bold 16px Poppins";
          ctx.textAlign = "center";

          for (let i = visibleStart; i <= visibleEnd; i++) {
            const x = centerX + i * spacing;

            if (x >= 0 && x <= canvas.width) {
              ctx.strokeStyle = i === 0 ? "#5B21B6" : "#A78BFA";
              ctx.lineWidth = i === 0 ? 3 : 2;
              ctx.beginPath();
              ctx.moveTo(x, centerY - 10);
              ctx.lineTo(x, centerY + 10);
              ctx.stroke();

              ctx.fillStyle = "#5B21B6";
              ctx.fillText(i.toString(), x, centerY + 30);
            }
          }

          // Gambar panah dengan warna flash
          if (arrows[1].length !== 0) {
            const color1 =
              arrowNum === 1 && flashCount % 2 === 0
                ? highlightColor
                : originalColor1;
            drawArrow(arrows[1], color1, centerY - 50, centerX);
          }

          if (arrows[2].length !== 0) {
            const color2 =
              arrowNum === 2 && flashCount % 2 === 0
                ? highlightColor
                : originalColor2;
            drawArrow(arrows[2], color2, centerY - 80, centerX);
          }

          flashCount++;
        }, 200);
      }

      function updateArrowDisplays() {
        document.getElementById("arrow1-start").value = arrows[1].start;
        document.getElementById("arrow1-length").value = arrows[1].length;
        document.getElementById("arrow2-start").value = arrows[2].start;
        document.getElementById("arrow2-length").value = arrows[2].length;
      }

      function changeSpacing(delta) {
        spacing = Math.max(20, Math.min(80, spacing + delta));
        drawNumberLine();
      }

      function drawNumberLine() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        const centerY = canvas.height / 2;
        const centerX = canvas.width / 2;

        const visibleStart = Math.floor((0 - centerX) / spacing) - 2;
        const visibleEnd = Math.ceil((canvas.width - centerX) / spacing) + 2;

        ctx.strokeStyle = "#A78BFA";
        ctx.lineWidth = 4;
        ctx.beginPath();
        ctx.moveTo(0, centerY);
        ctx.lineTo(canvas.width, centerY);
        ctx.stroke();

        ctx.fillStyle = "#5B21B6";
        ctx.font = "bold 16px Poppins";
        ctx.textAlign = "center";

        for (let i = visibleStart; i <= visibleEnd; i++) {
          const x = centerX + i * spacing;

          if (x >= 0 && x <= canvas.width) {
            ctx.strokeStyle = i === 0 ? "#5B21B6" : "#A78BFA";
            ctx.lineWidth = i === 0 ? 3 : 2;
            ctx.beginPath();
            ctx.moveTo(x, centerY - 10);
            ctx.lineTo(x, centerY + 10);
            ctx.stroke();

            ctx.fillStyle = "#5B21B6";
            ctx.fillText(i.toString(), x, centerY + 30);
          }
        }

        if (arrows[1].length !== 0) {
          drawArrow(arrows[1], "#10B981", centerY - 50, centerX);
        }

        if (arrows[2].length !== 0) {
          drawArrow(arrows[2], "#F59E0B", centerY - 80, centerX);
        }
      }

      function drawArrow(arrow, color, yPos, centerX) {
        const startX = centerX + arrow.start * spacing;
        const endX = centerX + (arrow.start + arrow.length) * spacing;

        ctx.strokeStyle = color;
        ctx.fillStyle = color;
        ctx.lineWidth = 4;

        ctx.beginPath();
        ctx.moveTo(startX, yPos);
        ctx.lineTo(endX, yPos);
        ctx.stroke();

        ctx.beginPath();
        ctx.arc(startX, yPos, 6, 0, Math.PI * 2);
        ctx.fill();

        if (arrow.length !== 0) {
          const angle = arrow.length > 0 ? 0 : Math.PI;
          ctx.beginPath();
          ctx.moveTo(endX, yPos);
          ctx.lineTo(
            endX - 15 * Math.cos(angle - Math.PI / 6),
            yPos - 15 * Math.sin(angle - Math.PI / 6)
          );
          ctx.lineTo(
            endX - 15 * Math.cos(angle + Math.PI / 6),
            yPos - 15 * Math.sin(angle + Math.PI / 6)
          );
          ctx.closePath();
          ctx.fill();
        }

        if (arrow.length !== 0) {
          ctx.fillStyle = color;
          ctx.font = "bold 14px Poppins";
          const midX = (startX + endX) / 2;
          const labelText =
            arrow.length > 0 ? `+${arrow.length}` : `${arrow.length}`;
          ctx.fillText(labelText, midX, yPos - 12);
        }
      }

      function addDigit(digit) {
        if (digit === "-" && userAnswer === "") {
          userAnswer = "-";
        } else if (digit !== "-") {
          userAnswer += digit;
        }
        document.getElementById("answerDisplay").textContent =
          userAnswer || "_";
      }

      function clearAnswer() {
        if (userAnswer.length > 0) {
          userAnswer = userAnswer.slice(0, -1);
          document.getElementById("answerDisplay").textContent =
            userAnswer || "_";
        }
      }

      function checkAnswer() {
        const feedback = document.getElementById("feedback");
        const answerBox = document.getElementById("answerDisplay");

        if (userAnswer === "") {
          feedback.textContent = "Masukkan jawaban dulu ya! üòä";
          feedback.className = "feedback";
          return;
        }

        const userNum = parseInt(userAnswer);

        if (userNum === currentQuestion.answer) {
          feedback.textContent = "Hebat! Jawabanmu benar üéâ";
          feedback.className = "feedback correct bounce";
          answerBox.style.background = "#D1FAE5";
          answerBox.style.borderColor = "#10B981";
        } else {
          feedback.textContent = "Coba lagi ya üòÖ";
          feedback.className = "feedback incorrect";
          answerBox.style.background = "#FEE2E2";
          answerBox.style.borderColor = "#EF4444";

          setTimeout(() => {
            answerBox.style.background = "#F3F4F6";
            answerBox.style.borderColor = "#C7D2FE";
          }, 2000);
        }
      }

      initCanvas();
      newQuestion();
    </script>
  </body>
</html>
